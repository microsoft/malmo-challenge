import pandas as pd
import matplotlib.pyplot as plt
import numpy as np


def plot_from_csv(csv_lst, steps_per_eval=20):
    """
    Plots specified csv results generated by chainerrl.
    :param csv_lst: tyype list, list of names of csv files to plot
    """
    results = []
    for csv_file in csv_lst:
        data = pd.read_table(csv_file)
        print(data)
        results.append(np.array(data['mean']))

    mean_results = np.mean(np.array(results), axis=0)
    std = np.std(results, axis=0)
    plt.plot(range(0, steps_per_eval * len(mean_results), steps_per_eval), mean_results, '.-b', markersize=4)
    plt.plot(range(0, steps_per_eval * len(mean_results), steps_per_eval), mean_results + 2 * std, '.-r', markersize=4)
    plt.plot(range(0, steps_per_eval * len(mean_results), steps_per_eval), mean_results - 2 * std, '.-r', markersize=4)
    plt.title('Performance during training')
    plt.xlabel("steps [k]")
    plt.ylabel("average normalized reward")
    plt.savefig('results.png')


if __name__ == '__main__':
    plot_from_csv(['final_results/scores1.txt', 'final_results/scores2.txt',
                                                'final_results/scores3.txt', 'final_results/scores4.txt'])
